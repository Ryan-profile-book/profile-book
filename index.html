<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë„·í”Œì—°ê°€ í”„ë¡œí•„ë¶</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    * { box-sizing: border-box; }
    html, body { margin:0; padding:0; height:100%; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:#e5e7eb;
      color:#222;
    }

    .bg {
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      padding:16px;
    }

    /* ğŸ“± ë©”ì¸ ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ */
    .phone {
      width:390px;
      height:700px;
      max-width:100%;
      max-height:100vh;
      border-radius:32px;
      overflow:hidden;
      box-shadow:0 24px 60px rgba(15,23,42,0.3);
      display:flex;
      flex-direction:column;
      background:linear-gradient(135deg,#ffe0f0,#fff5d9); /* ê¸°ë³¸ ìƒ‰ì§€ */
      transition:0.3s;
      position:relative;
    }

    /* ìƒ‰ì§€ íŒ¨í„´ë“¤ */
    .phone[data-pattern="sunrise"] { background:linear-gradient(135deg,#ffe0f0,#fff5d9); }
    .phone[data-pattern="lavender"] { background:linear-gradient(135deg,#e5e0ff,#fdf2ff); }
    .phone[data-pattern="mint"]     { background:linear-gradient(135deg,#d9fff2,#f2fff8); }
    .phone[data-pattern="sand"]     { background:linear-gradient(135deg,#fff4dd,#ffe9e0); }
    .phone[data-pattern="gray"]     { background:linear-gradient(135deg,#f2f2f2,#dcdcdc); }
    .phone[data-pattern="blue"]     { background:linear-gradient(135deg,#dce8ff,#c5d8ff); }
    .phone[data-pattern="navy"]     { background:linear-gradient(135deg,#6f7fb8,#4c5a99); }
    .phone[data-pattern="black"]    { background:linear-gradient(135deg,#333,#111); }

    /* ìƒë‹¨ ë°” */
    .top-bar {
      height:44px;
      padding:0 16px;
      display:flex;
      align-items:center;
      background:rgba(255,255,255,0.6);
      backdrop-filter:blur(10px);
      flex-shrink:0;
    }
    .exit-btn {
      border:none;
      background:none;
      font-size:14px;
      cursor:pointer;
    }

    /* ë³¸ë¬¸ ì»¨í…Œì´ë„ˆ */
    .page-container {
      flex:1;
      padding:12px;
      display:flex;
      background:transparent;
    }

    /* ğŸ¨ í…Œë‘ë¦¬ + í•˜ì–€ í˜ì´ì§€ (ìº¡ì²˜ ëŒ€ìƒ) */
    .page-frame {
      width:100%;
      height:100%;
      background:transparent;
      border-radius:24px;
      padding:10px;
    }

    .page-card {
      width:100%;
      height:100%;
      background:#ffffff;
      border-radius:20px;
      box-shadow:0 12px 30px rgba(15,23,42,0.08);
      padding:20px 14px;
      overflow-y:auto;
      position:relative;
    }

    .step { display:none; }
    .step.active { display:block; }

    /* ìƒë‹¨ í—¤ë” */
    .header-fixed {
      text-align:center;
      margin-bottom:14px;
      padding-top:8px;
    }
    .header-title {
      font-size:15px;
      font-weight:600;
    }
    .header-nickname {
      font-size:13px;
      opacity:0.7;
      margin-top:2px;
    }

    /* ìƒ‰ì§€ ì„ íƒ í˜ì´ì§€ */
    .pattern-title {
      text-align:center;
      font-size:16px;
      margin:18px 0 8px;
    }
    .pattern-grid {
      display:flex; flex-wrap:wrap;
      gap:10px; justify-content:center;
    }
    .pattern-card {
      padding:8px 16px;
      font-size:13px;
      border-radius:999px;
      border:1px solid #ddd;
      background:white;
      cursor:pointer;
    }
    .pattern-card.active {
      border-color:#ff8a3d;
      box-shadow:0 0 0 2px rgba(255,138,61,0.3);
    }

    .nickname-input {
      width:90%;
      margin:18px auto 0;
      display:block;
      padding:10px 14px;
      border-radius:14px;
      border:1px solid #ddd;
      font-size:14px;
    }

    /* í‘œì§€ */
    .cover-page {
      height:100%;
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      padding:40px 30px 32px;
    }
    .cover-top-label {
      font-size:11px;
      letter-spacing:0.18em;
      text-transform:uppercase;
      margin-bottom:40px;
      opacity:0.9;
    }
    .cover-main-title {
      font-size:30px;
      font-family:"Nanum Myeongjo","Apple SD Gothic Neo",serif;
      font-weight:600;
      margin-bottom:10px;
    }
    .cover-author {
      font-size:15px;
      margin-bottom:80px;
    }
    .cover-desc {
      font-size:14px;
      font-family:"Nanum Myeongjo","Apple SD Gothic Neo",serif;
      line-height:1.9;
      white-space:pre-line;
    }

    /* ì±•í„° */
    .chapter-title {
      text-align:center;
      margin-top:80px;
    }
    .chapter-ribbon {
      display:inline-block;
      padding:8px 20px;
      border-radius:999px;
      color:#fff;
      font-size:14px;
      font-weight:600;
      margin-bottom:22px;
      letter-spacing:0.08em;
      text-transform:uppercase;
    }
    .chapter1-ribbon { background:#f97373; }
    .chapter2-ribbon { background:#3b82f6; }
    .chapter3-ribbon { background:#10b981; }

    .chapter-heading {
      font-size:20px;
      font-family:"Nanum Myeongjo","Apple SD Gothic Neo",serif;
      line-height:1.9;
      white-space:pre-line;
    }

    /* ì§ˆë¬¸ */
    .question-title {
      text-align:center;
      font-size:16px;
      margin:16px 0 10px;
      font-family:"Apple SD Gothic Neo","Nanum Myeongjo",serif;
      white-space:pre-line;
    }

    .question-sub {
      font-size:12px;
      text-align:center;
      color:#777;
      white-space:pre-line;
      margin-bottom:10px;
    }

    /* ë‹µë³€ */
    .answer-block {
      margin-top:8px;
      text-align:center;
    }

    textarea {
      width:calc(100% - 10px);
      min-height:160px;
      border-radius:18px;
      padding:12px 12px;
      border:1px solid #ddd;
      font-size:15px;
      line-height:1.7;
      font-family:"Apple SD Gothic Neo", sans-serif;
      resize:none;
      text-align:left;
    }

    .answer-view {
      display:none;
      white-space:pre-wrap;
      line-height:1.7;
      font-size:15px;
      text-align:left;
      margin-top:4px;
    }

    /* ì¸ìƒì‘í’ˆ í¬ìŠ¤í„° ë¸”ëŸ­ */
    .poster-block {
      margin-top:8px;
      text-align:center;
    }
    .poster-label {
      font-size:12px;
      color:#555;
      margin-bottom:6px;
    }
    .poster-preview-wrap {
      width:200px;
      height:260px;
      margin:0 auto 8px;
      border-radius:16px;
      border:1px dashed #ddd;
      background:#f9fafb;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      font-size:11px;
      color:#999;
    }
    .poster-preview-wrap img {
      max-width:100%;
      max-height:100%;
      display:none;
    }
    .poster-input {
      font-size:11px;
    }

    /* ìº¡ì²˜ ëª¨ë“œì—ì„œëŠ” textarea ìˆ¨ê¸°ê³  viewë§Œ */
    body.capture-mode textarea { display:none; }
    body.capture-mode .answer-view { display:block; }

    /* í•˜ë‹¨ ë²„íŠ¼ */
    .bottom-nav {
      height:66px;
      padding:8px 16px 14px;
      background:rgba(255,255,255,0.7);
      backdrop-filter:blur(10px);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-shrink:0;
    }

    .nav-btn {
      min-width:90px;
      border:none;
      padding:8px 12px;
      border-radius:999px;
      background:#f3f4f6;
      font-size:14px;
      cursor:pointer;
    }
    .nav-btn.primary {
      background:#111827;
      color:white;
    }
    .nav-btn:disabled { opacity:0.35; }

    .progress-text {
      flex:1;
      text-align:center;
      font-size:12px;
      color:#777;
    }
  </style>
</head>

<body>
<div class="bg">
  <div class="phone" id="phone" data-pattern="sunrise">

    <header class="top-bar">
      <button class="exit-btn" onclick="goFirst()">Ã— ë‚˜ê°€ê¸°</button>
    </header>

    <main class="page-container">
      <!-- â¬‡ ìº¡ì²˜ ëŒ€ìƒ -->
      <div class="page-frame" id="capture-target">
        <div class="page-card">

          <!-- STEP 0 : ìƒ‰ì§€ + ë‹‰ë„¤ì„ -->
          <section class="step active" data-step="0">
            <div class="pattern-title">ë°°ê²½ ìƒ‰ì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”</div>

            <div class="pattern-grid">
              <button class="pattern-card active" data-pattern="sunrise">ì„ ë¼ì´ì¦ˆ</button>
              <button class="pattern-card" data-pattern="lavender">ë¼ë²¤ë”</button>
              <button class="pattern-card" data-pattern="mint">ë¯¼íŠ¸</button>
              <button class="pattern-card" data-pattern="sand">ìƒŒë“œ</button>
              <button class="pattern-card" data-pattern="gray">ê·¸ë ˆì´</button>
              <button class="pattern-card" data-pattern="blue">ë¸”ë£¨</button>
              <button class="pattern-card" data-pattern="navy">ë„¤ì´ë¹„</button>
              <button class="pattern-card" data-pattern="black">ì°¨ì½œ ë¸”ë™</button>
            </div>

            <input class="nickname-input" id="nicknameInput" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" />
          </section>

          <!-- STEP 1 : í‘œì§€ -->
          <section class="step" data-step="1">
            <div class="cover-page">
              <div class="cover-top-label">ë„·í”Œì—°ê°€</div>
              <div class="cover-main-title">ë‚˜ì˜ í”„ë¡œí•„ë¶</div>
              <div class="cover-author">
                <span id="coverName"></span> ì§€ìŒ
              </div>
              <div class="cover-desc">
ë‚˜ì˜ ì·¨í–¥ì„
í•œ í˜ì´ì§€ì”© ì±„ì›Œê°€ëŠ” ì‹œê°„
with ì„ì§€ë¡œ ì·¨í–¥ê´€
              </div>
            </div>
          </section>

          <!-- STEP 2 : ì±•í„° 1 -->
          <section class="step" data-step="2">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <div class="chapter-title">
              <div class="chapter-ribbon chapter1-ribbon">Chapter 1</div>
              <div class="chapter-heading">ë‚¨ì´ ë³´ëŠ” ë‚˜,
ë‚´ê°€ ë³´ëŠ” ë‚˜</div>
            </div>
          </section>

          <!-- CH1 Q1 : ë‚¨ë“¤ì´ ë³´ëŠ” ë‚˜ -->
          <section class="step" data-step="3">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q1. ë‚¨ë“¤ì´ ë³´ëŠ”<br>ë‚˜ì˜ í‚¤ì›Œë“œ 3ê°€ì§€ì™€ ê·¸ ì´ìœ </h2>
            <div class="question-sub">ì˜ˆ) ì°¨ë¶„í•œ, ì±…ì„ê° ìˆëŠ”, ì¥ë‚œê¸° ë§ì€ ë“±</div>

            <div class="answer-block">
              <textarea id="q1" placeholder="- í‚¤ì›Œë“œ 1 : ì´ìœ 
- í‚¤ì›Œë“œ 2 : ì´ìœ 
- í‚¤ì›Œë“œ 3 : ì´ìœ "></textarea>
              <div class="answer-view" id="q1-view"></div>
            </div>
          </section>

          <!-- CH1 Q2 : ë‚´ê°€ ë³´ëŠ” ë‚˜ -->
          <section class="step" data-step="4">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q2. ë‚´ê°€ ìƒê°í•˜ëŠ”<br>ë‚˜ì˜ í‚¤ì›Œë“œ 3ê°€ì§€ì™€ ê·¸ ì´ìœ </h2>
            <div class="question-sub">ë‚¨ë“¤ì´ ë³´ëŠ” ë‚˜ì™€ ì–¼ë§ˆë‚˜ ê²¹ì¹˜ëŠ”ì§€ ë¹„êµí•´ë³´ì„¸ìš”</div>

            <div class="answer-block">
              <textarea id="q2" placeholder="- í‚¤ì›Œë“œ 1 : ì´ìœ 
- í‚¤ì›Œë“œ 2 : ì´ìœ 
- í‚¤ì›Œë“œ 3 : ì´ìœ "></textarea>
              <div class="answer-view" id="q2-view"></div>
            </div>
          </section>

          <!-- CH1 Q3 : í˜¼ì ìˆì„ ë•Œì˜ ë‚˜ -->
          <section class="step" data-step="5">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q3. í˜¼ì ìˆì„ ë•Œì˜ ë‚˜</h2>
            <div class="question-sub">ìƒê°, í–‰ë™, ë£¨í‹´ ë“±ì„ ë– ì˜¬ë¦¬ë©° ì ì–´ì£¼ì„¸ìš”</div>

            <div class="answer-block">
              <textarea id="q3" placeholder="í˜¼ì ìˆì„ ë•Œ ë‚˜ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ì§€, ë¬´ì—‡ì„ í•˜ë©° ì‹œê°„ì„ ë³´ë‚´ëŠ”ì§€ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q3-view"></div>
            </div>
          </section>

          <!-- CH1 Q4 : ì¹œêµ¬ì™€ ìˆì„ ë•Œì˜ ë‚˜ -->
          <section class="step" data-step="6">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q4. ì¹œêµ¬ì™€ ìˆì„ ë•Œì˜ ë‚˜</h2>

            <div class="answer-block">
              <textarea id="q4" placeholder="ì¹œêµ¬ ì‚¬ì´ì—ì„œ ë‚˜ëŠ” ì–´ë–¤ ì—­í• ì¸ì§€, ì–´ë–¤ ëª¨ìŠµìœ¼ë¡œ ìˆëŠ”ì§€ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q4-view"></div>
            </div>
          </section>

          <!-- CH1 Q5 : ì—°ì¸ê³¼ ìˆì„ ë•Œì˜ ë‚˜ -->
          <section class="step" data-step="7">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q5. ì—°ì¸ê³¼ ìˆì„ ë•Œì˜ ë‚˜</h2>

            <div class="answer-block">
              <textarea id="q5" placeholder="ì—°ì¸ ì•ì—ì„œ ë‚˜ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ì§€, í‰ì†Œì™€ ë‹¬ë¼ì§€ëŠ” ì ì´ ìˆë‹¤ë©´ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q5-view"></div>
            </div>
          </section>

          <!-- CH1 Q6 : ê°€ì¡±ê³¼ ìˆì„ ë•Œì˜ ë‚˜ -->
          <section class="step" data-step="8">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q6. ê°€ì¡±ê³¼ ìˆì„ ë•Œì˜ ë‚˜</h2>

            <div class="answer-block">
              <textarea id="q6" placeholder="ê°€ì¡± ì•ì—ì„œëŠ” ì–´ë–¤ ì—­í• ì¸ì§€, ì–´ë–¤ íƒœë„ì¸ì§€ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q6-view"></div>
            </div>
          </section>

          <!-- CH1 Q7 : íšŒì‚¬ì—ì„œì˜ ë‚˜ -->
          <section class="step" data-step="9">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q7. íšŒì‚¬(ì¼í•  ë•Œ)ì˜ ë‚˜</h2>

            <div class="answer-block">
              <textarea id="q7" placeholder="ì¼í•  ë•Œ ë‚˜ëŠ” ì–´ë–¤ ìŠ¤íƒ€ì¼ì¸ì§€, ë™ë£Œë“¤ì€ ë‚˜ë¥¼ ì–´ë–»ê²Œ ë³¼ì§€ ìƒìƒí•´ì„œ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q7-view"></div>
            </div>
          </section>

          <!-- CH1 Q8 : ë§ˆìŒì— ë“œëŠ” ë¶€ë¶„ -->
          <section class="step" data-step="10">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q8. ë‚˜ì˜ ëª¨ìŠµ ì¤‘<br>ë§ˆìŒì— ë“œëŠ” ë¶€ë¶„</h2>

            <div class="answer-block">
              <textarea id="q8" placeholder="ë‚´ê°€ ìŠ¤ìŠ¤ë¡œ ì¢‹ì•„í•˜ëŠ” ë‚˜ì˜ íƒœë„, ì„±ê²©, í–‰ë™ë“¤ì„ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q8-view"></div>
            </div>
          </section>

          <!-- CH1 Q9 : ë§ˆìŒì— ë“¤ì§€ ì•ŠëŠ” ë¶€ë¶„ -->
          <section class="step" data-step="11">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q9. ë‚˜ì˜ ëª¨ìŠµ ì¤‘<br>ë§ˆìŒì— ë“¤ì§€ ì•ŠëŠ” ë¶€ë¶„</h2>

            <div class="answer-block">
              <textarea id="q9" placeholder="ê³ ì¹˜ê³  ì‹¶ê±°ë‚˜, ë‹¤ë£¨ê¸° ì–´ë ¤ìš´ ë‚˜ì˜ ëª¨ìŠµë“¤ì„ ì†”ì§í•˜ê²Œ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q9-view"></div>
            </div>
          </section>

          <!-- CH1 Q10 : ë‚˜ëŠ” ___í•œ ì‚¬ëŒì´ë‹¤ -->
          <section class="step" data-step="12">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q10. í•œ ë¬¸ì¥ìœ¼ë¡œ ì ì–´ë³´ëŠ” ë‚˜</h2>
            <div class="question-sub">â€œë‚˜ëŠ” ______í•œ ì‚¬ëŒì´ë‹¤.â€ ë¥¼ ì™„ì„±í•´ë³´ì„¸ìš”</div>

            <div class="answer-block">
              <textarea id="q10" placeholder="ë‚˜ëŠ” ____________í•œ ì‚¬ëŒì´ë‹¤."></textarea>
              <div class="answer-view" id="q10-view"></div>
            </div>
          </section>

          <!-- STEP 13 : ì±•í„° 2 -->
          <section class="step" data-step="13">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <div class="chapter-title">
              <div class="chapter-ribbon chapter2-ribbon">Chapter 2</div>
              <div class="chapter-heading">ì·¨í–¥ìœ¼ë¡œ
ë§í•˜ëŠ” ë‚˜</div>
            </div>
          </section>

          <!-- CH2 Q1 : ì¸ìƒ ì‘í’ˆ + í¬ìŠ¤í„° -->
          <section class="step" data-step="14">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q11. ë‚˜ì˜ ì¸ìƒ ì‘í’ˆ</h2>
            <div class="question-sub">ì˜í™”, ë“œë¼ë§ˆ, ì±…, ìŒì•… ë“± í˜•ì‹ì€ ìƒê´€ì—†ì–´ìš”.</div>

            <div class="poster-block">
              <div class="poster-label">ì¸ìƒ ì‘í’ˆì˜ í¬ìŠ¤í„° / í‘œì§€ë¥¼ ì²¨ë¶€í•´ë³´ì„¸ìš” (ì„ íƒ)</div>
              <div class="poster-preview-wrap">
                <span id="posterPlaceholder">ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</span>
                <img id="posterPreview" alt="í¬ìŠ¤í„° ë¯¸ë¦¬ë³´ê¸°" />
              </div>
              <input type="file" accept="image/*" id="posterInput" class="poster-input">
            </div>

            <div class="answer-block">
              <textarea id="q11" placeholder="ì‘í’ˆëª… / ì‘ê°€(ê°ë…) / ë‚˜ì—ê²Œ íŠ¹ë³„í•œ ì´ìœ "></textarea>
              <div class="answer-view" id="q11-view"></div>
            </div>
          </section>

          <!-- CH2 Q2 : ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ì¥ë©´ -->
          <section class="step" data-step="15">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q12. ê·¸ ì‘í’ˆì—ì„œ<br>ë‚´ê°€ ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ì¥ë©´ê³¼ ì´ìœ </h2>

            <div class="answer-block">
              <textarea id="q12" placeholder="ì–´ë–¤ ì¥ë©´ì´ì—ˆëŠ”ì§€, ê·¸ë•Œ ëŠê¼ˆë˜ ê°ì •ì€ ì–´ë• ëŠ”ì§€ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q12-view"></div>
            </div>
          </section>

          <!-- CH2 Q3 : í•œ ë¬¸ì¥ ìš”ì•½ -->
          <section class="step" data-step="16">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q13. ê·¸ ì‘í’ˆì„<br>í•œ ë¬¸ì¥ìœ¼ë¡œ ìš”ì•½í•œë‹¤ë©´?</h2>

            <div class="answer-block">
              <textarea id="q13" placeholder="ì˜ˆ) ìƒì²˜ ì…ì€ ì‚¬ëŒë“¤ì´ ì„œë¡œë¥¼ ë³´ë“¬ìœ¼ë©° ë²„í‹°ëŠ” ì´ì•¼ê¸°."></textarea>
              <div class="answer-view" id="q13-view"></div>
            </div>
          </section>

          <!-- CH2 Q4 : ë‹®ì€ ê°ì • -->
          <section class="step" data-step="17">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q14. ê·¸ ì‘í’ˆ ì† ê°ì • ì¤‘<br>ë‚˜ì™€ ë‹®ì•˜ë‹¤ê³  ëŠë‚€ ê°ì •</h2>

            <div class="answer-block">
              <textarea id="q14" placeholder="ì˜ˆ) ì±…ì„ê° ë•Œë¬¸ì— ì‰½ê²Œ ë¬´ë„ˆì§€ì§€ ëª»í•˜ëŠ” ì¸ë¬¼ì—ê²Œì„œ ë‚˜ë¥¼ ë´¤ë‹¤."></textarea>
              <div class="answer-view" id="q14-view"></div>
            </div>
          </section>

          <!-- CH2 Q5 : ì•ˆ ëŒë¦¬ëŠ” ì‘í’ˆë“¤ -->
          <section class="step" data-step="18">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q15. ë‚´ê°€ ì˜ ëŒë¦¬ì§€ ì•ŠëŠ” ì‘í’ˆë“¤ê³¼ ê·¸ ì´ìœ </h2>
            <div class="question-sub">ì˜ˆ) ê³¼í•œ ìê·¹, ë„ˆë¬´ ì „ê°œê°€ ë¹ ë¥¸ ì´ì•¼ê¸° ë“±</div>

            <div class="answer-block">
              <textarea id="q15" placeholder="ì–´ë–¤ ìŠ¤íƒ€ì¼ì„ ì–´ë ¤ì›Œí•˜ëŠ”ì§€, ì´ìœ ì™€ í•¨ê»˜ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q15-view"></div>
            </div>
          </section>

          <!-- CH2 Q6 : ë‚˜ëŠ” ___í•œ ì´ì•¼ê¸°ì— ëŒë¦¬ëŠ” ì‚¬ëŒì´ë‹¤ -->
          <section class="step" data-step="19">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q16. ë‚˜ëŠ” ______í•œ ì´ì•¼ê¸°ì—<br>ëŒë¦¬ëŠ” ì‚¬ëŒì´ë‹¤.</h2>

            <div class="answer-block">
              <textarea id="q16" placeholder="ë‚˜ëŠ” ____________í•œ ì´ì•¼ê¸°ì— ëŒë¦¬ëŠ” ì‚¬ëŒì´ë‹¤."></textarea>
              <div class="answer-view" id="q16-view"></div>
            </div>
          </section>

          <!-- STEP 20 : ì±•í„° 3 -->
          <section class="step" data-step="20">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <div class="chapter-title">
              <div class="chapter-ribbon chapter3-ribbon">Chapter 3</div>
              <div class="chapter-heading">ë‚˜ì˜
ì—°ì•  ì·¨í–¥</div>
            </div>
          </section>

          <!-- CH3 Q1 : ì—°ì•  ìŠ¤íƒ€ì¼ 3ë‹¨ì–´ -->
          <section class="step" data-step="21">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q17. ë‚˜ì˜ ì—°ì•  ìŠ¤íƒ€ì¼ì„<br>ë³´ì—¬ì£¼ëŠ” 3ë‹¨ì–´</h2>

            <div class="answer-block">
              <textarea id="q17" placeholder="ì˜ˆ) ì°¨ë¶„í•œ / í‘œí˜„ì´ ë§ì€ / ì²œì²œíˆ ê¹Šì–´ì§€ëŠ”"></textarea>
              <div class="answer-view" id="q17-view"></div>
            </div>
          </section>

          <!-- CH3 Q2 : ì‚¬ë‘ë°›ëŠ” ìˆœê°„ -->
          <section class="step" data-step="22">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q18. ì‚¬ë‘ë°›ëŠ”ë‹¤ê³ <br>ëŠë¼ëŠ” ìˆœê°„</h2>

            <div class="answer-block">
              <textarea id="q18" placeholder="ì–´ë–¤ ë§, í–‰ë™, ìƒí™©ì—ì„œ â€˜ì•„, ë‚˜ ì‚¬ë‘ë°›ê³  ìˆêµ¬ë‚˜â€™ë¥¼ ëŠë¼ëŠ”ì§€ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q18-view"></div>
            </div>
          </section>

          <!-- CH3 Q3 : ì‚¬ë‘ë°›ì§€ ëª»í•œë‹¤ê³  ëŠë¼ëŠ” ìˆœê°„ -->
          <section class="step" data-step="23">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q19. ì‚¬ë‘ë°›ì§€ ëª»í•œë‹¤ê³ <br>ëŠë¼ëŠ” ìˆœê°„</h2>

            <div class="answer-block">
              <textarea id="q19" placeholder="ì˜ˆ) ì—°ë½ íŒ¨í„´, ë§íˆ¬, íƒœë„ ë“± ë‚˜ë¥¼ ì™¸ë¡­ê²Œ ë§Œë“œëŠ” ìˆœê°„ë“¤."></textarea>
              <div class="answer-view" id="q19-view"></div>
            </div>
          </section>

          <!-- CH3 Q4 : ì˜ ë§ëŠ” ì‚¬ëŒë“¤ì˜ ê³µí†µì  -->
          <section class="step" data-step="24">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q20. ë‚˜ì™€ ì˜ ë§ëŠ”<br>ì‚¬ëŒë“¤ì˜ ê³µí†µì </h2>

            <div class="answer-block">
              <textarea id="q20" placeholder="ì—ë„ˆì§€, ëŒ€í™” ìŠ¤íƒ€ì¼, ìƒí™œ ë¦¬ë“¬ ë“± ê³µí†µì ì„ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q20-view"></div>
            </div>
          </section>

          <!-- CH3 Q5 : í‰ë²”í•œ í•˜ë£¨ ë°ì´íŠ¸ -->
          <section class="step" data-step="25">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q21. ë‚´ê°€ ê¿ˆê¾¸ëŠ”<br>â€˜í‰ë²”í•œ í•˜ë£¨ ë°ì´íŠ¸â€™</h2>

            <div class="answer-block">
              <textarea id="q21" placeholder="ì•„ì¹¨ë¶€í„° ë°¤ê¹Œì§€, í•¨ê»˜ ë³´ë‚´ê³  ì‹¶ì€ í•˜ë£¨ë¥¼ ìƒìƒí•´ì„œ ì ì–´ì£¼ì„¸ìš”."></textarea>
              <div class="answer-view" id="q21-view"></div>
            </div>
          </section>

          <!-- CH3 Q6 : ë‚˜ëŠ” ___í•œ ì—°ì•  ì·¨í–¥ -->
          <section class="step" data-step="26">
            <div class="header-fixed">
              <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
              <div class="header-nickname"></div>
            </div>

            <h2 class="question-title">Q22. ë‚˜ëŠ” ______í•œ<br>ì—°ì•  ì·¨í–¥ì„ ê°€ì§„ ì‚¬ëŒì´ë‹¤.</h2>

            <div class="answer-block">
              <textarea id="q22" placeholder="ë‚˜ëŠ” ____________í•œ ì—°ì•  ì·¨í–¥ì„ ê°€ì§„ ì‚¬ëŒì´ë‹¤."></textarea>
              <div class="answer-view" id="q22-view"></div>
            </div>
          </section>

        </div>
      </div>
    </main>

    <footer class="bottom-nav">
      <button class="nav-btn" id="prev-btn">â† ì´ì „</button>
      <div class="progress-text" id="progress-text">1 / 27</div>
      <button class="nav-btn primary" id="next-btn">ë‹¤ìŒ â†’</button>
    </footer>

  </div>
</div>

<!-- html2canvas -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<!-- JSZip (ZIP ë¬¶ê¸°ìš©) -->
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

<script>
  const phone = document.getElementById("phone");
  const steps = Array.from(document.querySelectorAll(".step"));
  const prevBtn = document.getElementById("prev-btn");
  const nextBtn = document.getElementById("next-btn");
  const progressText = document.getElementById("progress-text");
  const totalSteps = steps.length;

  let currentStep = 0;
  let nickname = "";

  /* ìƒ‰ì§€ ì„ íƒ */
  document.querySelectorAll(".pattern-card").forEach(btn => {
    btn.addEventListener("click", () => {
      document.querySelectorAll(".pattern-card").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      phone.setAttribute("data-pattern", btn.dataset.pattern);
    });
  });

  /* ë‹‰ë„¤ì„ ë°˜ì˜ */
  function applyNickname() {
    nickname = document.getElementById("nicknameInput").value.trim();

    document.querySelectorAll(".header-nickname").forEach(el => {
      el.textContent = nickname;
    });

    const coverName = document.getElementById("coverName");
    if (coverName) coverName.textContent = nickname || "";
  }

  /* textarea â†” ë³´ê¸°ëª¨ë“œ ì‹±í¬ (ìë™) */
  document.querySelectorAll("textarea[id^='q']").forEach(ta => {
    const view = document.getElementById(ta.id + "-view");
    if (!view) return;
    const sync = () => { view.textContent = ta.value; };
    ta.addEventListener("input", sync);
    sync();
  });

  /* ì¸ìƒ ì‘í’ˆ í¬ìŠ¤í„° ë¯¸ë¦¬ë³´ê¸° */
  const posterInput = document.getElementById("posterInput");
  const posterPreview = document.getElementById("posterPreview");
  const posterPlaceholder = document.getElementById("posterPlaceholder");

  if (posterInput && posterPreview) {
    posterInput.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) {
        posterPreview.src = "";
        posterPreview.style.display = "none";
        if (posterPlaceholder) posterPlaceholder.style.display = "block";
        return;
      }
      const reader = new FileReader();
      reader.onload = (ev) => {
        posterPreview.src = ev.target.result;
        posterPreview.style.display = "block";
        if (posterPlaceholder) posterPlaceholder.style.display = "none";
      };
      reader.readAsDataURL(file);
    });
  }

  function updateStepUI() {
    steps.forEach((s,i)=>s.classList.toggle("active",i===currentStep));
    progressText.textContent = `${currentStep+1} / ${totalSteps}`;
    prevBtn.disabled = currentStep===0;

    if(currentStep===totalSteps-1) nextBtn.textContent="ì™„ë£Œ(ì „ì²´ ì €ì¥)";
    else nextBtn.textContent="ë‹¤ìŒ â†’";

    if(currentStep>0) applyNickname();
  }

  prevBtn.addEventListener("click", () => {
    if(currentStep>0){ currentStep--; updateStepUI(); }
  });

  nextBtn.addEventListener("click", async () => {
    if(currentStep<totalSteps-1){
      currentStep++; updateStepUI();
    } else {
      await saveAllPagesAsImages();
    }
  });

  function goFirst() {
    currentStep=0; updateStepUI();
  }

  /* íŠ¹ì • stepì„ canvasë¡œ ìº¡ì²˜ */
  async function captureStepToCanvas(stepIndex){
    currentStep = stepIndex;
    updateStepUI();
    await new Promise(r=>setTimeout(r,250));

    document.body.classList.add("capture-mode");
    await new Promise(r=>setTimeout(r,60));

    const target = document.getElementById("phone");
    const canvas = await html2canvas(target, {
      scale: 2,
      useCORS: true,
      allowTaint: true
    });

    document.body.classList.remove("capture-mode");
    return canvas;
  }

  /* ì „ì²´ í˜ì´ì§€ë¥¼ ZIPìœ¼ë¡œ ë¬¶ì–´ì„œ ë‹¤ìš´ë¡œë“œ */
  async function saveAllPagesAsImages(){
    const zip = new JSZip();

    for(let step=1; step<totalSteps; step++){
      const canvas = await captureStepToCanvas(step);
      const dataUrl = canvas.toDataURL("image/png");
      const base64 = dataUrl.split(',')[1];
      zip.file(`profile-page-${step}.png`, base64, { base64: true });
    }

    const content = await zip.generateAsync({ type: "blob" });

    const link = document.createElement("a");
    link.href = URL.createObjectURL(content);
    link.download = "profile-book.zip";
    link.click();

    alert("ğŸ“˜ ëª¨ë“  í˜ì´ì§€ë¥¼ ZIP íŒŒì¼ë¡œ ì €ì¥í–ˆìŠµë‹ˆë‹¤! (ì•ˆë“œë¡œì´ë“œì—ì„  PCì—ì„œ ì—¬ëŠ” ê±¸ ì¶”ì²œí•´ìš”)");
  }

  updateStepUI();
</script>

</body>
</html>
