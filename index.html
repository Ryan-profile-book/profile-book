<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë„·í”Œì—°ê°€ í”„ë¡œí•„ë¶</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; }
    html, body { margin:0; padding:0; height:100%; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:#e5e7eb;
      color:#222;
      transition:0.2s;
    }

    .bg {
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      padding:16px;
    }

    /* ğŸ“± ëª¨ë°”ì¼ í™”ë©´ ê³ ì • */
    .phone {
      width:390px;
      height:780px;
      max-width:100%;
      max-height:100vh;
      border-radius:32px;
      overflow:hidden;
      box-shadow:0 24px 60px rgba(15,23,42,0.3);
      display:flex;
      flex-direction:column;
      background:linear-gradient(135deg,#fef5ff,#f5f7fb);
      transition:0.3s;
    }

    /* ğŸ“„ í˜ì´ì§€ ë°°ê²½ íŒ¨í„´ (ê¸°ì¡´ 4ê°œ) */
    .phone[data-pattern="sunrise"] {
      background:linear-gradient(135deg,#ffe0f0,#fff5d9);
    }
    .phone[data-pattern="lavender"] {
      background:linear-gradient(135deg,#e5e0ff,#fdf2ff);
    }
    .phone[data-pattern="mint"] {
      background:linear-gradient(135deg,#d9fff2,#f2fff8);
    }
    .phone[data-pattern="sand"] {
      background:linear-gradient(135deg,#fff4dd,#ffe9e0);
    }

    /* â­ ì¶”ê°€ëœ 4ê°œ (ë°¤í•˜ëŠ˜2 + ì¢…ì´ì§ˆê°2) */
    .phone[data-pattern="night1"] {
      background:linear-gradient(135deg,#1c1f4a,#0a0c24);
    }
    .phone[data-pattern="night2"] {
      background:linear-gradient(135deg,#2a2759,#120f2d);
    }
    .phone[data-pattern="paper1"] {
      background:url('https://i.imgur.com/nWQe5CZ.png');
      background-size:cover;
    }
    .phone[data-pattern="paper2"] {
      background:url('https://i.imgur.com/k4IYtOQ.png');
      background-size:cover;
    }

    .top-bar {
      height:44px;
      padding:0 16px;
      display:flex;
      align-items:center;
      background:rgba(255,255,255,0.6);
      backdrop-filter:blur(10px);
    }
    .exit-btn {
      border:none;
      background:none;
      font-size:14px;
      cursor:pointer;
    }

    .page-container {
      flex:1;
      padding:12px;
      display:flex;
    }

    /* ğŸ“š ìº¡ì²˜ë  ì˜ì—­ */
    .page-inner {
      width:100%;
      height:100%;
      padding:20px 14px;
      background:white;
      border-radius:24px;
      overflow-y:auto;
      box-shadow:0 12px 30px rgba(15,23,42,0.08);
      position:relative;
    }

    .step { display:none; }
    .step.active { display:block; }

    /* --- í—¤ë” (ë‹‰ë„¤ì„ í¬í•¨, ìº¡ì²˜ í¬í•¨) --- */
    .header-fixed {
      text-align:center;
      margin-top:8px;
      margin-bottom:18px;
    }
    .header-title {
      font-size:15px;
      font-weight:600;
    }
    .header-nickname {
      font-size:12px;
      margin-top:3px;
      opacity:0.6;
    }

    /* í˜ì´ì§€ ë²ˆí˜¸ */
    .page-number {
      position:absolute;
      right:14px;
      bottom:14px;
      font-size:12px;
      opacity:0.7;
    }

    /* ğŸ¨ ìƒ‰ì§€ ì„ íƒ */
    .pattern-title {
      text-align:center;
      font-size:16px;
      margin:28px 0 12px;
    }
    .pattern-grid {
      display:flex; flex-wrap:wrap;
      gap:10px; justify-content:center;
    }
    .pattern-card {
      padding:8px 16px;
      font-size:13px;
      border-radius:999px;
      border:1px solid #ddd;
      background:white;
      cursor:pointer;
    }
    .pattern-card.active {
      border-color:#ff8a3d;
      box-shadow:0 0 0 2px rgba(255,138,61,0.3);
    }

    .nickname-input {
      width:90%;
      margin:18px auto 0;
      display:block;
      padding:10px 14px;
      border-radius:14px;
      border:1px solid #ddd;
      font-size:14px;
    }

    /* ğŸ· íƒ€ì´í‹€ */
    .title-page {
      text-align:center;
      margin-top:80px;
    }
    .title-heading {
      font-size:24px;
      font-weight:700;
      margin-bottom:6px;
    }
    .title-sub {
      font-size:13px;
      color:#666;
      line-height:1.6;
    }

    /* ğŸ“– ì±•í„° */
    .chapter-title { text-align:center; margin-top:80px; }
    .chapter-label {
      font-size:24px;
      letter-spacing:0.15em;
      font-weight:700;
      background:linear-gradient(90deg,#ff7a3c,#ff4b7d,#ff8a3d);
      -webkit-background-clip:text;
      color:transparent;
    }
    .chapter-number {
      font-size:36px;
      font-weight:700;
      color:#ff5a3c;
      margin:4px 0 16px;
    }
    .chapter-sub {
      font-size:17px;
      font-family:"Apple SD Gothic Neo","Nanum Myeongjo",serif;
    }

    /* âœ ì§ˆë¬¸ */
    .question-title {
      text-align:center;
      font-size:17px;
      margin:24px 0 18px;
      font-family:"Apple SD Gothic Neo","Nanum Myeongì¡°",serif;
    }

    .image-placeholder {
      margin:0 auto 16px;
      width:220px; height:170px;
      border-radius:24px;
      border:1px dashed #ffd0a6;
      background:#fff7f0;
      display:flex; align-items:center; justify-content:center;
      font-size:11px; color:#d28b4a;
    }

    .answer-block { margin-top:8px; }

    textarea {
      width:100%;
      min-height:160px;
      border-radius:18px;
      padding:12px 14px;
      border:1px solid #ddd;
      font-size:14px; line-height:1.7;
      resize:vertical;
    }

    /* ğŸ“˜ ìº¡ì²˜ëª¨ë“œì¼ ë•Œ í…ìŠ¤íŠ¸ë§Œ ë³´ì´ê¸° */
    .answer-view {
      display:none;
      white-space:pre-wrap;
      line-height:1.8;
      font-size:14px;
      color:#333;
      margin-top:4px;
    }

    body.capture-mode textarea { display:none; }
    body.capture-mode .answer-view { display:block; }

    /* í•˜ë‹¨ ë²„íŠ¼ */
    .bottom-nav {
      height:68px;
      padding:8px 16px 14px;
      background:rgba(255,255,255,0.7);
      backdrop-filter:blur(10px);
      display:flex; align-items:center; gap:12px;
    }
    .nav-btn {
      min-width:90px;
      border:none;
      padding:8px 12px;
      border-radius:999px;
      background:#f3f4f6;
      font-size:13px;
      cursor:pointer;
    }
    .nav-btn.primary { background:#111827; color:white; }
    .nav-btn:disabled { opacity:0.35; cursor:default; }

    .progress-text {
      flex:1;
      text-align:center;
      font-size:12px;
      color:#777;
    }
  </style>
</head>

<body>
<div class="bg">
  <div class="phone" id="phone" data-pattern="sunrise">

    <header class="top-bar">
      <button class="exit-btn" onclick="goFirst()">Ã— ë‚˜ê°€ê¸°</button>
    </header>

    <main class="page-container">
      <div class="page-inner" id="capture-target">

        <!-- STEP 0 : ìƒ‰ì§€ + ë‹‰ë„¤ì„ -->
        <section class="step active" data-step="0">
          <div class="pattern-title">ë°°ê²½ ìƒ‰ì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”</div>
          <div class="pattern-grid">
            <button class="pattern-card active" data-pattern="sunrise">ì„ ë¼ì´ì¦ˆ</button>
            <button class="pattern-card" data-pattern="lavender">ë¼ë²¤ë”</button>
            <button class="pattern-card" data-pattern="mint">ë¯¼íŠ¸</button>
            <button class="pattern-card" data-pattern="sand">ìƒŒë“œ</button>
            <button class="pattern-card" data-pattern="night1">ë°¤í•˜ëŠ˜1</button>
            <button class="pattern-card" data-pattern="night2">ë°¤í•˜ëŠ˜2</button>
            <button class="pattern-card" data-pattern="paper1">ì¢…ì´ì§ˆê°1</button>
            <button class="pattern-card" data-pattern="paper2">ì¢…ì´ì§ˆê°2</button>
          </div>

          <input class="nickname-input" id="nicknameInput" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" />
        </section>

        <!-- STEP 1 : íƒ€ì´í‹€ -->
        <section class="step" data-step="1">
          <div class="title-page">
            <div class="title-heading">ë‚˜ì˜ í”„ë¡œí•„ë¶</div>
            <div class="title-sub">
              ë„·í”Œì—°ê°€ì—ì„œ ë§Œë‚œ ë‚˜ì˜ ì·¨í–¥ì„<br>
              í•œ í˜ì´ì§€ì”© ì±„ì›Œê°€ëŠ” ì‹œê°„
            </div>
          </div>
        </section>

        <!-- STEP 2 : CHAPTER 1 -->
        <section class="step" data-step="2">
          <div class="header-fixed">
            <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
            <div class="header-nickname" id="headerName2"></div>
          </div>

          <div class="chapter-title">
            <div class="chapter-label">CHAPTER</div>
            <div class="chapter-number">1</div>
            <div class="chapter-sub">ì±•í„° 1 ì œëª©</div>
          </div>

          <div class="page-number" data-pg="1"></div>
        </section>

        <!-- STEP 3 : ì§ˆë¬¸ 1 -->
        <section class="step" data-step="3">
          <div class="header-fixed">
            <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
            <div class="header-nickname" id="headerName3"></div>
          </div>

          <h2 class="question-title">ì§ˆë¬¸ 1</h2>
          <div class="image-placeholder">ì´ë¯¸ì§€ëŠ” ë‚˜ì¤‘ì—</div>

          <div class="answer-block">
            <textarea id="q1" placeholder="ë‹µë³€ 1ì„ ì ì–´ì£¼ì„¸ìš”."></textarea>
            <div class="answer-view" id="q1-view"></div>
          </div>

          <div class="page-number" data-pg="2"></div>
        </section>

        <!-- STEP 4 : ì§ˆë¬¸ 2 -->
        <section class="step" data-step="4">
          <div class="header-fixed">
            <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
            <div class="header-nickname" id="headerName4"></div>
          </div>

          <h2 class="question-title">ì§ˆë¬¸ 2</h2>
          <div class="image-placeholder"></div>

          <div class="answer-block">
            <textarea id="q2" placeholder="ë‹µë³€ 2ë¥¼ ì ì–´ì£¼ì„¸ìš”."></textarea>
            <div class="answer-view" id="q2-view"></div>
          </div>

          <div class="page-number" data-pg="3"></div>
        </section>

        <!-- STEP 5 : CHAPTER 2 -->
        <section class="step" data-step="5">
          <div class="header-fixed">
            <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
            <div class="header-nickname" id="headerName5"></div>
          </div>

          <div class="chapter-title">
            <div class="chapter-label">CHAPTER</div>
            <div class="chapter-number">2</div>
            <div class="chapter-sub">ì±•í„° 2 ì œëª©</div>
          </div>

          <div class="page-number" data-pg="4"></div>
        </section>

        <!-- STEP 6 : ì§ˆë¬¸ 3 -->
        <section class="step" data-step="6">
          <div class="header-fixed">
            <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
            <div class="header-nickname" id="headerName6"></div>
          </div>

          <h2 class="question-title">ì§ˆë¬¸ 3</h2>
          <div class="image-placeholder"></div>

          <div class="answer-block">
            <textarea id="q3" placeholder="ë‹µë³€ 3ì„ ì ì–´ì£¼ì„¸ìš”."></textarea>
            <div class="answer-view" id="q3-view"></div>
          </div>

          <div class="page-number" data-pg="5"></div>
        </section>

        <!-- STEP 7 : ì§ˆë¬¸ 4 -->
        <section class="step" data-step="7">
          <div class="header-fixed">
            <div class="header-title">ë‚˜ì˜ í”„ë¡œí•„ë¶ - ì„ì§€ë¡œ ì·¨í–¥ê´€</div>
            <div class="header-nickname" id="headerName7"></div>
          </div>

          <h2 class="question-title">ì§ˆë¬¸ 4</h2>
          <div class="image-placeholder"></div>

          <div class="answer-block">
            <textarea id="q4" placeholder="ë‹µë³€ 4ë¥¼ ì ì–´ì£¼ì„¸ìš”."></textarea>
            <div class="answer-view" id="q4-view"></div>
          </div>

          <div class="page-number" data-pg="6"></div>
        </section>

      </div>
    </main>

    <footer class="bottom-nav">
      <button class="nav-btn" id="prev-btn">â† ì´ì „</button>
      <div class="progress-text" id="progress-text">1 / 8</div>
      <button class="nav-btn primary" id="next-btn">ë‹¤ìŒ â†’</button>
    </footer>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
  const phone = document.getElementById("phone");
  const steps = Array.from(document.querySelectorAll(".step"));
  const prevBtn = document.getElementById("prev-btn");
  const nextBtn = document.getElementById("next-btn");
  const progressText = document.getElementById("progress-text");
  const totalSteps = steps.length;
  let currentStep = 0;
  let nickname = "";

  /* íŒ¨í„´ ì„ íƒ */
  document.querySelectorAll(".pattern-card").forEach(btn => {
    btn.addEventListener("click", () => {
      document.querySelectorAll(".pattern-card").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      phone.setAttribute("data-pattern", btn.dataset.pattern);
    });
  });

  /* nickname ì ìš© */
  function setNickname() {
    nickname = document.getElementById("nicknameInput").value.trim();
    if (!nickname) nickname = "";

    ["headerName2","headerName3","headerName4","headerName5","headerName6","headerName7"]
      .forEach(id => document.getElementById(id).textContent = nickname);
  }

  /* textarea â†’ answer-view ì‹±í¬ */
  ["q1","q2","q3","q4"].forEach(id => {
    const ta = document.getElementById(id);
    const v = document.getElementById(id+"-view");
    if (!ta) return;

    const sync = () => v.textContent = ta.value;
    ta.addEventListener("input", sync);
    sync();
  });

  function updateStepUI() {
    steps.forEach((s,i)=>s.classList.toggle("active",i===currentStep));
    progressText.textContent=`${currentStep+1} / ${totalSteps}`;

    prevBtn.disabled = currentStep===0;

    if (currentStep===0) nextBtn.textContent="ë‹¤ìŒ â†’";
    else if (currentStep===totalSteps-1) nextBtn.textContent="ì™„ë£Œ(ì „ì²´ ì €ì¥)";
    else nextBtn.textContent="ë‹¤ìŒ â†’";

    if (currentStep>0) setNickname();
  }

  prevBtn.addEventListener("click",()=>{
    if(currentStep>0){ currentStep--; updateStepUI(); }
  });

  nextBtn.addEventListener("click", async ()=>{
    if(currentStep<totalSteps-1){
      currentStep++; updateStepUI();
    } else {
      await saveAllPagesAsImages();
    }
  });

  function goFirst(){
    currentStep=0; updateStepUI();
  }

  async function captureStep(stepIndex){
    currentStep = stepIndex;
    updateStepUI();
    await new Promise(r=>setTimeout(r,250));

    document.body.classList.add("capture-mode");
    await new Promise(r=>setTimeout(r,100));

    const target = document.getElementById("capture-target");
    const canvas = await html2canvas(target,{scale:2});

    document.body.classList.remove("capture-mode");

    const link=document.createElement("a");
    link.download=`profile-book-step${stepIndex}.png`;
    link.href=canvas.toDataURL("image/png");
    link.click();

    await new Promise(r=>setTimeout(r,200));
  }

  async function saveAllPagesAsImages(){
    for(let step=1; step<totalSteps; step++){
      await captureStep(step);
    }
    alert("ğŸ“˜ ëª¨ë“  í˜ì´ì§€ ì €ì¥ ì™„ë£Œ!");
  }

  updateStepUI();
</script>

</body>
</html>
